<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#3F56CE"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2025-01-23T19:26:31.2684693"><title>UpdatesRepository [Class] | Voci App Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"constructor","level":0,"title":"Constructor","anchor":"#constructor"},{"id":"methods","level":0,"title":"Methods","anchor":"#methods"},{"id":"error-handling","level":0,"title":"Error Handling","anchor":"#error-handling"},{"id":"notes","level":0,"title":"Notes","anchor":"#notes"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b575/app.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/voci-logo.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="UpdatesRepository [Class] | Voci App Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Voci App Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/updates-repository.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="UpdatesRepository [Class] | Voci App Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/updates-repository.html#webpage",
    "url": "writerside-documentation/updates-repository.html",
    "name": "UpdatesRepository [Class] | Voci App Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Voci App Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="Updates-Repository" data-main-title="UpdatesRepository [Class]" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="App.md|App///Data-Package.md|Data [Folder]///Repository.md|Repository [Package]"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Voci App Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Updates-Repository" id="Updates-Repository.md">UpdatesRepository [Class]</h1><p id="pt7v9z_3">The <code class="code" id="pt7v9z_8">UpdatesRepository</code> class manages <code class="code" id="pt7v9z_9">Update</code> objects and provides functionality for adding, updating, deleting, and fetching updates from both a local Room database and a remote Firestore database. It also handles offline functionality by queuing operations for synchronization when the device is offline and automatically syncing them once the device is online.</p><section class="chapter"><h2 id="constructor" data-toc="constructor">Constructor</h2><section class="chapter"><h3 id="updatesrepository-firestoredatasource-firestoredatasource-roomdatasource-roomdatasource-networkmanager-networkmanager" data-toc="updatesrepository-firestoredatasource-firestoredatasource-roomdatasource-roomdatasource-networkmanager-networkmanager"><code class="code" id="pt7v9z_15">UpdatesRepository(firestoreDataSource: FirestoreDataSource, roomDataSource: RoomDataSource, networkManager: NetworkManager)</code></h3><p id="pt7v9z_12">The constructor requires instances of the following classes:</p><ul class="list _bullet" id="pt7v9z_13"><li class="list__item" id="pt7v9z_16"><p id="pt7v9z_20"><span class="control" id="pt7v9z_21">firestoreDataSource</span>: Handles remote Firestore operations.</p></li><li class="list__item" id="pt7v9z_17"><p id="pt7v9z_22"><span class="control" id="pt7v9z_23">roomDataSource</span>: Handles local Room database operations.</p></li><li class="list__item" id="pt7v9z_18"><p id="pt7v9z_24"><span class="control" id="pt7v9z_25">networkManager</span>: Used to check the device's network connectivity status.</p></li><li class="list__item" id="pt7v9z_19"><p id="pt7v9z_26"><span class="control" id="pt7v9z_28">Parameters</span>:</p><ul class="list _bullet" id="pt7v9z_27"><li class="list__item" id="pt7v9z_29"><p><code class="code" id="pt7v9z_32">firestoreDataSource</code>: An instance of <code class="code" id="pt7v9z_33">FirestoreDataSource</code> to interact with Firestore.</p></li><li class="list__item" id="pt7v9z_30"><p><code class="code" id="pt7v9z_34">roomDataSource</code>: An instance of <code class="code" id="pt7v9z_35">RoomDataSource</code> to interact with the local Room database.</p></li><li class="list__item" id="pt7v9z_31"><p><code class="code" id="pt7v9z_36">networkManager</code>: An instance of <code class="code" id="pt7v9z_37">NetworkManager</code> to check the device's network connectivity.</p></li></ul></li></ul></section></section><section class="chapter"><h2 id="methods" data-toc="methods">Methods</h2><section class="chapter"><h3 id="addupdate-update-update-resource-update" data-toc="addupdate-update-update-resource-update"><code class="code" id="pt7v9z_45">addUpdate(update: Update): Resource&lt;Update&gt;</code></h3><p id="pt7v9z_43">Adds a new <code class="code" id="pt7v9z_46">Update</code> object both locally and remotely (if online). If the device is offline, the data is saved locally and queued for later synchronization.</p><ul class="list _bullet" id="pt7v9z_44"><li class="list__item" id="pt7v9z_47"><p><span class="control" id="pt7v9z_49">Parameters</span>: </p><ul class="list _bullet" id="pt7v9z_50"><li class="list__item" id="pt7v9z_51"><p><code class="code" id="pt7v9z_52">update</code>: The <code class="code" id="pt7v9z_53">Update</code> object to be added.</p></li></ul></li><li class="list__item" id="pt7v9z_48"><p><span class="control" id="pt7v9z_54">Returns</span>: </p><ul class="list _bullet" id="pt7v9z_55"><li class="list__item" id="pt7v9z_56"><p><code class="code" id="pt7v9z_58">Resource.Success</code>: The <code class="code" id="pt7v9z_59">Update</code> object if added successfully.</p></li><li class="list__item" id="pt7v9z_57"><p><code class="code" id="pt7v9z_60">Resource.Error</code>: An error message if an issue occurs (e.g., offline or Firestore failure).</p></li></ul></li></ul></section><section class="chapter"><h3 id="getupdates-flow-resource-list-update" data-toc="getupdates-flow-resource-list-update"><code class="code" id="pt7v9z_64">getUpdates(): Flow&lt;Resource&lt;List&lt;Update&gt;&gt;&gt;</code></h3><p id="pt7v9z_62">Fetches a list of all <code class="code" id="pt7v9z_65">Update</code> objects stored in the local Room database.</p><ul class="list _bullet" id="pt7v9z_63"><li class="list__item" id="pt7v9z_66"><p><span class="control" id="pt7v9z_67">Returns</span>: </p><ul class="list _bullet" id="pt7v9z_68"><li class="list__item" id="pt7v9z_69"><p><code class="code" id="pt7v9z_70">Flow&lt;Resource&lt;List&lt;Update&gt;&gt;&gt;</code>: A flow that emits the list of updates from the local Room database.</p></li></ul></li></ul></section><section class="chapter"><h3 id="syncpendingactions" data-toc="syncpendingactions"><code class="code" id="pt7v9z_74">syncPendingActions()</code></h3><p id="pt7v9z_72">Syncs any pending actions (add, update, or delete) that were queued while the device was offline. This method only works if the device is online.</p><ul class="list _bullet" id="pt7v9z_73"><li class="list__item" id="pt7v9z_75"><p><span class="control" id="pt7v9z_76">Returns</span>: </p><ul class="list _bullet" id="pt7v9z_77"><li class="list__item" id="pt7v9z_78"><p><code class="code" id="pt7v9z_79">Unit</code>: No return value. The method synchronizes the pending actions with Firestore.</p></li></ul></li></ul></section><section class="chapter"><h3 id="fetchupdatesfromfirestoretoroom" data-toc="fetchupdatesfromfirestoretoroom"><code class="code" id="pt7v9z_84">fetchUpdatesFromFirestoreToRoom()</code></h3><p id="pt7v9z_81">Fetches the list of <code class="code" id="pt7v9z_85">Update</code> objects from Firestore and updates the local Room database. If the device is offline, no action is performed.</p><ul class="list _bullet" id="pt7v9z_82"><li class="list__item" id="pt7v9z_86"><p><span class="control" id="pt7v9z_87">Returns</span>: </p><ul class="list _bullet" id="pt7v9z_88"><li class="list__item" id="pt7v9z_89"><p><code class="code" id="pt7v9z_90">Unit</code>: No return value. The method updates the local Room database with data from Firestore.</p></li></ul></li></ul></section></section><section class="chapter"><h2 id="error-handling" data-toc="error-handling">Error Handling</h2><ul class="list _bullet" id="pt7v9z_91"><li class="list__item" id="pt7v9z_93"><p>The repository uses <code class="code" id="pt7v9z_95">Resource</code> wrappers to handle success and error responses. <code class="code" id="pt7v9z_96">Resource.Success</code> is returned when operations are successful, and <code class="code" id="pt7v9z_97">Resource.Error</code> is returned when an error occurs.</p></li><li class="list__item" id="pt7v9z_94"><p>Error messages for failed operations, such as being offline or Firestore errors, are included in the <code class="code" id="pt7v9z_98">Resource.Error</code> responses.</p></li></ul></section><section class="chapter"><h2 id="notes" data-toc="notes">Notes</h2><ul class="list _bullet" id="pt7v9z_99"><li class="list__item" id="pt7v9z_101"><p>The repository ensures offline functionality by using Room as the local database. When the device is offline, actions are queued for synchronization with Firestore once the device reconnects to the network.</p></li><li class="list__item" id="pt7v9z_102"><p>The <code class="code" id="pt7v9z_104">syncPendingActions</code> method processes any actions that were not completed while the device was offline.</p></li><li class="list__item" id="pt7v9z_103"><p>The <code class="code" id="pt7v9z_105">fetchUpdatesFromFirestoreToRoom</code> method ensures that the local Room database is kept up-to-date with Firestore, and it removes any records that no longer exist remotely.</p></li></ul></section><div class="last-modified">Last modified: 23 January 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="request-repository.html" class="navigation-links__prev">RequestRepository [Class]</a><a href="volunteer-repository.html" class="navigation-links__next">VolunteerRepository [Class]</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b575/app.js"></script></body></html>